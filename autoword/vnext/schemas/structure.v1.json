{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://autoword.com/schemas/structure.v1.json",
  "title": "AutoWord vNext Structure V1 Schema",
  "description": "Document structure schema for AutoWord vNext pipeline - skeleton and metadata only",
  "type": "object",
  "required": ["schema_version", "metadata", "styles", "paragraphs", "headings", "fields", "tables"],
  "additionalProperties": false,
  "properties": {
    "schema_version": {
      "type": "string",
      "const": "structure.v1"
    },
    "metadata": {
      "type": "object",
      "properties": {
        "title": {"type": ["string", "null"]},
        "author": {"type": ["string", "null"]},
        "creation_time": {"type": ["string", "null"], "format": "date-time"},
        "modified_time": {"type": ["string", "null"], "format": "date-time"},
        "word_version": {"type": ["string", "null"]},
        "page_count": {"type": ["integer", "null"], "minimum": 0},
        "paragraph_count": {"type": ["integer", "null"], "minimum": 0},
        "word_count": {"type": ["integer", "null"], "minimum": 0}
      },
      "additionalProperties": false
    },
    "styles": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["name", "type"],
        "additionalProperties": false,
        "properties": {
          "name": {"type": "string", "minLength": 1, "maxLength": 255},
          "type": {"type": "string", "enum": ["paragraph", "character", "table", "linked"]},
          "font": {
            "type": ["object", "null"],
            "properties": {
              "east_asian": {"type": ["string", "null"]},
              "latin": {"type": ["string", "null"]},
              "size_pt": {"type": ["integer", "null"], "minimum": 1, "maximum": 72},
              "bold": {"type": ["boolean", "null"]},
              "italic": {"type": ["boolean", "null"]},
              "color_hex": {"type": ["string", "null"], "pattern": "^#[0-9A-Fa-f]{6}$"}
            },
            "additionalProperties": false
          },
          "paragraph": {
            "type": ["object", "null"],
            "properties": {
              "line_spacing_mode": {"type": ["string", "null"], "enum": ["SINGLE", "MULTIPLE", "EXACTLY"]},
              "line_spacing_value": {"type": ["number", "null"], "minimum": 0.1, "maximum": 10.0},
              "space_before_pt": {"type": ["number", "null"], "minimum": 0, "maximum": 1000},
              "space_after_pt": {"type": ["number", "null"], "minimum": 0, "maximum": 1000},
              "indent_left_pt": {"type": ["number", "null"], "minimum": 0, "maximum": 1000},
              "indent_right_pt": {"type": ["number", "null"], "minimum": 0, "maximum": 1000},
              "indent_first_line_pt": {"type": ["number", "null"], "minimum": -1000, "maximum": 1000}
            },
            "additionalProperties": false
          },
          "based_on": {"type": ["string", "null"]},
          "next_style": {"type": ["string", "null"]}
        }
      }
    },
    "paragraphs": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["index", "preview_text", "is_heading"],
        "additionalProperties": false,
        "properties": {
          "index": {"type": "integer", "minimum": 0},
          "style_name": {"type": ["string", "null"]},
          "preview_text": {"type": "string", "maxLength": 120},
          "is_heading": {"type": "boolean"},
          "heading_level": {"type": ["integer", "null"], "minimum": 1, "maximum": 9}
        }
      }
    },
    "headings": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["paragraph_index", "level", "text"],
        "additionalProperties": false,
        "properties": {
          "paragraph_index": {"type": "integer", "minimum": 0},
          "level": {"type": "integer", "minimum": 1, "maximum": 9},
          "text": {"type": "string", "minLength": 1, "maxLength": 255},
          "style_name": {"type": ["string", "null"]}
        }
      }
    },
    "fields": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["paragraph_index", "field_type"],
        "additionalProperties": false,
        "properties": {
          "paragraph_index": {"type": "integer", "minimum": 0},
          "field_type": {"type": "string", "minLength": 1},
          "field_code": {"type": ["string", "null"]},
          "result_text": {"type": ["string", "null"]}
        }
      }
    },
    "tables": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["paragraph_index", "rows", "columns", "has_header"],
        "additionalProperties": false,
        "properties": {
          "paragraph_index": {"type": "integer", "minimum": 0},
          "rows": {"type": "integer", "minimum": 1},
          "columns": {"type": "integer", "minimum": 1},
          "has_header": {"type": "boolean"},
          "cell_references": {
            "type": ["array", "null"],
            "items": {"type": "integer", "minimum": 0}
          }
        }
      }
    }
  }
}