# AutoWord vNext CLI Usage Guide

## Overview

The AutoWord vNext CLI provides a comprehensive command-line interface for the vNext pipeline with support for single document processing, batch operations, dry-run mode, and extensive configuration options.

## Installation and Setup

The CLI is automatically available when the AutoWord vNext package is installed:

```bash
python -m autoword.vnext.cli --help
```

## Commands

### 1. Process Single Document

Process a single DOCX file with user intent:

```bash
# Basic usage
python -m autoword.vnext.cli process document.docx "Remove abstract and references"

# With specific model and verbose output
python -m autoword.vnext.cli process document.docx "Remove sections" --model gpt4 --verbose

# With custom audit directory
python -m autoword.vnext.cli process document.docx "Format document" --audit-dir ./my-audits

# With debug monitoring
python -m autoword.vnext.cli process document.docx "Update styles" --monitoring-level debug --verbose
```

### 2. Batch Processing

Process multiple DOCX files in a directory:

```bash
# Basic batch processing
python -m autoword.vnext.cli batch ./documents "Apply standard formatting"

# With performance monitoring
python -m autoword.vnext.cli batch ./docs "Standardize" --monitoring-level performance --verbose

# With custom memory thresholds
python -m autoword.vnext.cli batch ./files "Process" --memory-warning-threshold 512 --memory-critical-threshold 1024
```

### 3. Dry Run Mode

Generate execution plans without actually modifying documents:

```bash
# Basic dry run
python -m autoword.vnext.cli dry-run document.docx "Update TOC and styles"

# Dry run with verbose output
python -m autoword.vnext.cli dry-run document.docx "Remove sections" --verbose --model gpt4
```

### 4. Configuration Management

Manage CLI configuration settings:

```bash
# Show current configuration
python -m autoword.vnext.cli config show

# Create configuration template
python -m autoword.vnext.cli config create my-config.json

# Use configuration file
python -m autoword.vnext.cli process document.docx "Process" --config my-config.json

# Save current settings to config file
python -m autoword.vnext.cli process document.docx "Test" --model gpt4 --save-config my-config.json
```

### 5. System Status Check

Check system requirements and status:

```bash
python -m autoword.vnext.cli status
```

## Global Options

### Core Options

- `--verbose, -v`: Enable verbose output and progress reporting
- `--audit-dir AUDIT_DIR`: Base directory for audit trails (default: ./audit_trails)
- `--model {gpt4,gpt35,claude37,claude3}`: LLM model to use for plan generation
- `--temperature TEMPERATURE`: LLM temperature (default: 0.1)
- `--visible`: Show Word application windows during processing
- `--log-file LOG_FILE`: Log file path

### Monitoring and Performance Options

- `--monitoring-level {basic,detailed,debug,performance}`: Monitoring detail level (default: detailed)
- `--disable-memory-monitoring`: Disable memory usage monitoring
- `--memory-warning-threshold MEMORY_WARNING_THRESHOLD`: Memory warning threshold in MB (default: 1024)
- `--memory-critical-threshold MEMORY_CRITICAL_THRESHOLD`: Memory critical threshold in MB (default: 2048)

### Configuration Options

- `--config CONFIG`: Configuration file path (JSON format)
- `--save-config SAVE_CONFIG`: Save current configuration to file

## Configuration File Format

Configuration files use JSON format:

```json
{
  "model": "gpt4",
  "temperature": 0.1,
  "audit_dir": "./audit_trails",
  "visible": false,
  "verbose": false,
  "monitoring_level": "detailed",
  "enable_memory_monitoring": true,
  "memory_warning_threshold": 1024,
  "memory_critical_threshold": 2048,
  "log_file": null
}
```

## Exit Codes

The CLI returns specific exit codes for different scenarios:

- `0`: Success
- `1`: General error
- `2`: Failed validation (changes rolled back)
- `3`: Rollback performed due to error
- `4`: Invalid plan generated by LLM
- `5`: Unknown status

## Examples

### Example 1: Standard Document Processing

```bash
# Process a research paper to remove abstract and references
python -m autoword.vnext.cli process research_paper.docx "Remove abstract and references sections" --verbose
```

### Example 2: Batch Processing with Custom Configuration

```bash
# Create configuration
python -m autoword.vnext.cli config create batch-config.json

# Edit batch-config.json to set preferred options
# Then process all documents
python -m autoword.vnext.cli batch ./documents "Apply formatting standards" --config batch-config.json
```

### Example 3: Development and Testing

```bash
# Check system status
python -m autoword.vnext.cli status

# Dry run to test plan generation
python -m autoword.vnext.cli dry-run test_document.docx "Update TOC and apply styles" --verbose

# Process with debug monitoring
python -m autoword.vnext.cli process test_document.docx "Test processing" --monitoring-level debug --verbose --log-file debug.log
```

### Example 4: Production Batch Processing

```bash
# Process large batch with performance monitoring
python -m autoword.vnext.cli batch ./production_docs "Standardize formatting" \
  --monitoring-level performance \
  --memory-warning-threshold 2048 \
  --memory-critical-threshold 4096 \
  --audit-dir ./production_audits \
  --log-file production.log \
  --verbose
```

## Troubleshooting

### Common Issues

1. **No LLM API keys**: Set `OPENAI_API_KEY` or `ANTHROPIC_API_KEY` environment variables
2. **Word COM not available**: Ensure Microsoft Word is installed
3. **Memory issues**: Adjust memory thresholds with `--memory-warning-threshold` and `--memory-critical-threshold`
4. **Permission errors**: Run with appropriate permissions for file access

### Debug Mode

Use debug monitoring for detailed troubleshooting:

```bash
python -m autoword.vnext.cli process document.docx "intent" --monitoring-level debug --verbose --log-file debug.log
```

### System Check

Always run system status check first:

```bash
python -m autoword.vnext.cli status
```

## Integration with Other Tools

The CLI can be integrated into scripts and workflows:

```bash
#!/bin/bash
# Batch processing script
for dir in ./projects/*/documents; do
    echo "Processing $dir"
    python -m autoword.vnext.cli batch "$dir" "Apply standards" --config production.json
done
```

## Performance Considerations

- Use `--monitoring-level performance` for performance-focused processing
- Adjust memory thresholds based on available system memory
- Use configuration files to avoid repeating options
- Consider `--visible` flag only for debugging (slows processing)

This CLI implementation provides comprehensive functionality for all vNext pipeline operations with extensive configuration options and monitoring capabilities.